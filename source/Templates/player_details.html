{% import 'scorecard.html' as scorecard %}
{% import 'plot.html' as plot %}
{% extends "main.html" %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/player.css') }}">
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/not_found.css') }}">
{% endblock head %}

{% block content %}
<div class="container">
  <div class="profile-pic">
    <img class="player-pic" src="https://via.placeholder.com/150" alt="Profile Picture">
  </div>
  <div class="user-info">
    <h1>{{ data["player"].name }}</h1>
    <div class="player-nationalities">
      <span>Nationality:</span>
      <ul>
        {% for team_id, team_name in data["player"].get_teams() %}
        <li class="nationality"><a href="{{url_for('teams.team_details', team_id=team_id)}}">{{ team_name }}</a></li>
        {% endfor %}
      </ul>
    </div>
    <p><span>Date of Birth:</span> {{ data["player"].birth_date }}</p>
  </div>
</div>

{% if data["player"].positions %}
<div class="pitch-positions">
  <img src="/static/images/pitch.png" alt="player positions">
  {% for position in data["player"].positions %}
  <div class="marker {{ position.replace(' ', '-') }}"></div>
  {% endfor %}
</div>
{% endif %}

{% if data["appearances_summary"] %}
<table id="player-appearances-summary" class="table-data center">
  <thead>
    <tr>
      <th scope="col">Tournament</th>
      <th scope="col">Number of matches</th>
      <th scope="col">Goals</th>
      <th scope="col">Yellow Cards</th>
      <th scope="col">Red Cards</th>
    </tr>
  </thead>
  <tbody>
    {% for row in data["appearances_summary"] %}
    <tr class="row-on-hover-grey">
      <td class="expand">{{row.tournament_name}}</td>
      <td>{{row.number_of_matches}}</td>
      <td>{{row.number_of_goals}}</td>
      <td>{{row.yellow_cards}}</td>
      <td>{{row.red_cards}}</td>
    </tr>
    <tr class="hidden">
      <td colspan="5">
        {% for match in data["matches"][row.tournament_id] %}
        <a href="{{url_for('matches.match_details', match_id=match.match_id)}}">
          {{ scorecard.scorecard(match, False, True) }}
        </a>
        {% endfor %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if visualizations["minutes_played"] %}
<div id="charts">
  <div id="minutes-played" class="dashboard-container">
    {{ plot.plot(visualizations["minutes_played"], "minutes-played-pie", "Time spent on the pitch and bench") }}
  </div>
  <div id="starting" class="dashboard-container">
    {{ plot.plot(visualizations["starter_or_sub"], "starter-or-substitute-pie", "Games in starting 11 and as a substitution") }}
  </div>
</div>
{% endif %}

{% if data["awards"] %}
<table id="awards" class="table-data center">
  <caption>Individual awards</caption>
  <thead>
    <tr>
      <th scope="col">Award</th>
      <th scope="col">Description</th>
      <th scope="col">Tournament</th>
    </tr>
  </thead>
  <tbody>
    {% for award in data["awards"] %}
    <tr class="row-on-hover-grey">
      <td>{{award.name}}</td>
      <td>{{award.description}}</td>
      <td>{{award.tournament_name}}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if not data["player"].positions and not data["appearances_summary"] and not data["awards"] and not visualizations["minutes_played"] %}
{% include "no_data.html" %}
{% endif %}


<script src="{{ url_for('static', filename='scripts/collapsible_table.js')}}"></script>
<script src="{{ url_for('static', filename='scripts/pitch_positions.js')}}"></script>
{% endblock content %}